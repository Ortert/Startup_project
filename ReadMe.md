## Предсказание успешности стартапа (закроется или нет)

**Описание и цель проекта:**  

На основании данных о стартапах, функционировавших в период с 1970 по 2018 годы, необходимо разработать модель предсказывающую вероятность закрытия того или иного стартапа.

**Описание данных:**

Датасет состоит из двух файлов: тренировочный набор (около 53к записей) и тестовый набор (около 13к записей). Тренировочный набор содержит целевой признак status, указывающий на то, закрылся стартап или продолжает действовать. Временной период - '1970-01-01' по '2018-01-01'. Дата формирования выгрузки - '2018-01-01'

*kaggle_startups_train_01.csv* - информация (53 000) стартапах, которые будут использоваться в качестве обучающих данных.
*kaggle_startups_test_01.csv* - информация (13 000) стартапах, которые будут использоваться в качестве тестовых данных. Необходимо предсказать значение 'status' для каждого стартапа из этого датасета.
*kaggle_startups_sample_submit_01.csv* - файл с примером предсказаний в правильном формате.
name - идентификатор (название) стартапа в тестовом наборе.
status - целевой признак. Для каждого стартапа необходимо предсказать категориальное значение соответствующее прогнозу ['operating', 'closed'].

**Описание полей данных:**

*name* - Название стартапа  
*category_list* - Список категорий, к которым относится стартап  
*funding_total_usd* - Общая сумма финансирования в USD  
*status* - Статус стартапа (закрыт или действующий)  
*country_code* - Код страны  
*state_code* - Код штата  
*region* - Регион  
*city* - Город  
*funding_rounds* - Количество раундов финансирования  
*founded_at* - Дата основания  
*first_funding_at* - Дата первого раунда финансирования  
*last_funding_at* - Дата последнего раунда финансирования  
*closed_at* - Дата закрытия стартапа (если применимо)  
*lifetime* - Время существования стартапа в днях  

Целью настоящего исследования является разработка модели, предсказывающей вероятность закрытия того или иного стартапа, на основании данных о стартапах, функционировавших в период с 1970 по 2018 годы.

Необходимые для исследования данные загружены, проверены на корректность отображения, также выведены основные статистические параметры датасетов.

В рамках предварительной обработки:
- выявлены и обработаны пропуски в количественных и категориальных данных;
- тренировочный датасет проверен на наличие явных дубликатов и дубликатов по названию компании;
- значения, отображающие даты событий, переведены из строкового формата в формат datetime;
- сокращено количество уникальных значений категориальных признаков, для улучшения обобщающей способности модели

В рамках разведочного анализа:

- изучено распределение количественных параметров. Параметр 'funding_total_usd' имеет выбросы в виде отличительно больших значений, однако эти данные реальны и их удаление приведет к искуственному регулированию данных. Также опытным путем установлено, что удаление выявленных выбросов, снижает искомую метрику f1.
- изучено распределение категориальных параметров. Выявлено, что из за заполнения пропуков категорией 'unknown' и сокращения категорий за счет присваивания значения 'Other' непопулярным категориям, данные значения вышли в топ-категорий по количеству.
- сформированы графики рассеяния количественны признаков, относительно времени существования стартапа в днях. В качестве таргета пиняты значения столбца 'status'. Установлено что вероятность закрытия стартапа уменьшается с увеличением времени его существования, увеличением общей суммы инвестиций в стартап и увеличением количества раундов инвестирования, в которых поучавстовала рассматриваемая компания
- в распределении целевого признака имеется дисбаланс между категориями: количество объектов с параметром 'closed' составляет менее 10% от общего объема датасета.  
- определены топ - 10 сымых рискованных и безопасных категорий деятельности стартапов. 
- определены топ - 10 сымых рискованных и безопасных стран регистрации стартапов. 
В целом существенных различий в распределении количественных и категориальных параметров тренировочной и тестовой выборок, не выявлено.

Разработан новый синтетический признак 'sint', который представляет собой произведение общей суммы финансирования ('funding_total_usd') и количества инвестраундов, в которых учавствовала компаняи ('funding_rounds'), деленное на время существования компании 'lifetime'.
 
Выполнена проверка на мультиколлинеарность путем составления матрицы корреляции.  
В соответствии со шкалой Чеддока, в датасете имеются следующие зависимости:
- слабая связь между параметрами 'funding_rounds' и 'lifetime', а также 'delta_funding_days' и 'lifetime'
- умеренная связь между 'funding_rounds' и 'funding_total_usd', 'lifetime' и ,  а также 'delta_funding_days' и  'funding_total_usd'
- весьма высокая связь между 'funding_rounds' и 'delta_funding_days'.

В качестве финального набора отобраны следующие входные признаки:
- количественные: 'funding_total_usd', 'lifetime', 'delta_funding_days', 'funding_rounds' 
- категориальные: 'country_code', 'category_list', 'state_code', 'city'

По результату обучения на тренировочной выборке, определены следующие парааметры модели/пайплайна, формирующие наилучшие результаты на кросс-валидационной выборке:

- масштабирование: RobustScaler()
- кодирование: OneHotEncoder()
- обработка неизвестных значений: SimpleImputer()
- модель: RandomForestClassifier()
- метрика на кросс-валидационной выборке: 0.996

На основании лучшей модели, полученной при обучении модели получена метрика на тестовой выборке, составляющая f1 = 0.996

По результатам важности признаков лучшей модели, можно прийти к следующим выводам:
- менее на прогноз целевого признака влияют следующие входные параметры: 'funding_total_usd', 'funding_rounds', 'country_code', 'category_list', 'state_code', 'city';
- более всего на прогноз целевого признака влияют следующие входные параметры: 'first_funding_at', 'sint', 'last_funding_at',  'lifetime'.

На основании описанного выше, для повышения надежности инвестиций рекомендуется инвестировать в компании которые существуют на рынке более 7 лет и имеют общую сумму инвестиций более 2 000 000 USD. Топ - 10 сымых рискованных и безопасных категорий деятельности и стран регистрации стартапов определены на графиках в разделе 3. Полноценный разведочный анализ.

